!function(t){var e=function(e,a,o){var i=t('<div style="width:100%;height:70%">'),n=t('<canvas style="width:100%;height:20%">'),r=t('<div style="width:100%;height:10%;font-size:12px">');i.appendTo(e),n.appendTo(e),r.appendTo(e);var l=n[0].getContext("2d");n[0].width=n[0].offsetWidth,n[0].height=n[0].offsetHeight;var h=n[0].width,s=n[0].height;const p={Standard:L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:"&copy; OpenStreetMap contributors"}),Satellite:L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{maxZoom:18,attribution:"&copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, etc."}),Topographic:L.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{maxZoom:15,attribution:"Map data: &copy; OpenTopoMap (CC-BY-SA)"})};var c=L.map(i[0],{layers:[p.Topographic],zoomControl:!0});L.control.layers(p,null,{collapsed:!1}).addTo(c);for(var d=[],v=-90,f=90,m=180,g=-180,u=1e5,y=0,x=0,T=null,M=0,S=0,w=0;w<a.length;w++){w>0&&(a[w].ev=.9*a[w-1].ev+.1*a[w].ev),v=Math.max(a[w].lt,v),f=Math.min(a[w].lt,f),m=Math.min(a[w].lg,m),g=Math.max(a[w].lg,g),u=Math.min(a[w].ev,u),y=Math.max(a[w].ev,y);var k=L.latLng(a[w].lt,a[w].lg);if(d.push(k),0!==w)x+=k.distanceTo(T),a[w].dt=x,a[w-1].ev<a[w].ev&&(M+=a[w].ev-a[w-1].ev),a[w-1].ev>a[w].ev&&(S+=a[w-1].ev-a[w].ev);T=k}var b=Math.max(y-u,200),G=h/x,A=s/b,D=L.polyline(d,{color:"red",weight:2,opacity:.9}).addTo(c);c.fitBounds(D.getBounds()),l.fillStyle="white",l.fillRect(0,0,h,s),l.strokeStyle="lightgray";for(w=0;w<4;w++)l.beginPath(),l.moveTo(0,s/4*w),l.lineTo(h-1,s/4*w),l.stroke();for(l.fillStyle="rgba(0,127,0,0.5)",l.beginPath(),l.moveTo(0,s-(a[0].ev-u)*A),w=1;w<a.length;w++)l.lineTo(G*a[w].dt,s-(a[w].ev-u)*A);l.lineTo(h-1,s-1),l.lineTo(0,s-1),l.closePath(),l.fill(),l.strokeStyle="black",l.lineWidth=2,l.strokeRect(1,1,h-2,s-2),l.fillStyle="blue",l.font="12px Arial",l.fillText("+"+Math.round(b)+"m",5,16),l.fillText(Math.round(u)+"m",5,s-6);var F="Distance:"+Math.round(x)/1e3+"km / Low:"+Math.round(u)+"m / High:"+Math.round(y)+"m / Accent:+"+Math.round(M)+"m / Descent:"+Math.round(S)+"m";o&&(F+="[<a href='"+o+"' download>Download GPX</a>]"),F+=" (c)<a href='http://kanasys.com/gtech/'>kanasys.com</a>",r.html(F)};t.fn.showGpxTracksString=function(a){this.each((function(){var o=t.parseXML(a),i=[];t(o).find("trkpt").each((function(){var e=new Date(t(this).find("time").text());i.push({lt:parseFloat(t(this).attr("lat")),lg:parseFloat(t(this).attr("lon")),ev:parseFloat(t(this).find("ele").text()),tm:e})})),e(this,i)}))},t.fn.showGpxTracks=function(a){this.each((function(){var o=this,i=a||t(this).attr("src");i&&t.ajax({url:i,type:"GET",dataType:"xml",timeout:2e4,error:function(t){console.log(t)},success:function(a){var n=[];t(a).find("trkpt").each((function(){var e=new Date(t(this).find("time").text());n.push({lt:parseFloat(t(this).attr("lat")),lg:parseFloat(t(this).attr("lon")),ev:parseFloat(t(this).find("ele").text()),tm:e})})),n.length>1&&e(o,n,i)}})}))}}(jQuery);